# IP to Host Group

ip_to_host_group.py is a python script to add a list of IPs to the Cognito Host Group feature. 

## Prerequisites

Python3.5, and requests module.  A Vectra API key is also required and can be generated by going to My Profile and Generating an API token.

### Running

The script needs to be supplied the URL for the Cognito Brain, the API key, the file containing the list of IPs, and the Group to add the hosts to.


```
python3 ip_to_host_group.py https://vectra.local AAABBBCCCDDDEEEFFF ip_list_file GROUP
```



## Typical Usage

The file containing the list of IPs can contain individual IPs, IP ranges (must be within same /24), and IP subnets with CIDR notation.
Examples:
```
192.168.1.1
192.168.1.2
192.168.2.1-192.168.2.10
192.168.5.0/24
192.168.6.128/25
```
Lines starting with a '#' or ';' are ignored.

For groups that contain a space or other characters that are interpreted by the CLI, place group in double quotes.  
Example: "Cognito - Scanners"

## Recommendations
This script is intended for hosts that are statically IP addressed.  Pulling host containers for dynamically assigned IPs will result in undesirable outcome.   
After the script has been ran, review the output in the ip_to_host_group.log file to ensure proper operation.
Review the group in Cognito Detect and adjust the host membership as necessary.

## Logging
Informational messages are displayed to standard output indicating the hosts being added to groups.  This information is also written to the ip_to_host_group.log file in the local directory.

### Help Output
usage: ip_to_host_group.py [-h] cognito_url cognito_token input_file group

Import a list of IPs or subnets from a file specified, poll Cognito for the host containers with the specified IPs and add those hosts to the group specified.  Script will createthe group if necessary.  See ip_list.txt for sample syntax.

positional arguments:
  cognito_url    Cognito's brain url, eg https://brain.vectra.local
  cognito_token  Cognito's auth token
  input_file     Text file containing list of IPs and subnets
  group          Name of group to add hosts to

optional arguments:
  -h, --help     show this help message and exit


## Authors

* **Matt Pieklik** - *Initial work*

## License

This project is licensed under the MIT License - see the [LICENSE.md](LICENSE.md) file for details
